/* empty css               */(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=a(t);fetch(t.href,s)}})();const apiUrl="https://jgalat.github.io/ds-weapons-api/";var btnTutorial=document.querySelectorAll("#btnTutorial");btnTutorial.forEach(e=>{e.addEventListener("click",n=>{document.querySelector("#tutorial").checked=!0})});const numWeapons=116;var attempts=10,guessedWeapons=[],summWpnType=document.querySelector("#summWpnType"),summAtkType=document.querySelector("#summAtkType");document.querySelector("#summStrength");document.querySelector("#summDexterity");document.querySelector("#summIntelligence");document.querySelector("#summFaith");var summDmgType=document.querySelector("#summDmgType");function main(e){var n=-1;sessionStorage.length==0&&(n=Math.floor(Math.random()*numWeapons),sessionStorage.setItem("weaponId",n));var a=e,r=a[sessionStorage.getItem("weaponId")].name;console.log(a[sessionStorage.getItem("weaponId")].name),setModal(r),populateDropdown(a),document.querySelectorAll(".selection").forEach(t=>{t.addEventListener("click",s=>{if(document.querySelector("#searchInput").value="",document.querySelector("#myDropdown").classList.add("hidden"),selectValue(s)){var c=checkWeapon(s.target.id);attemptCounter(c),generateGuessBox(s,e)}})}),document.querySelector("#btnClue").addEventListener("click",t=>{t.target.style.display="none",getClue(a),attemptCounter()})}fetch(apiUrl).then(e=>e.json()).then(e=>{main(e)});function setModal(e,n){document.querySelectorAll("#modalImg").forEach(a=>{a.src="/weapons/"+sessionStorage.getItem("weaponId")+".png"}),document.querySelectorAll("#modalName").forEach(a=>{a.textContent=e}),document.querySelectorAll("#btnModal").forEach(a=>{a.addEventListener("click",refreshGame)})}function refreshGame(){sessionStorage.clear(),location.reload(!0)}function generateGuessBox(e,n){const a=e.target.id,r=n;var t=document.querySelector("#guessesDiv"),s=generateRow(),c=generateName(a,r),l=generateWpnType(a,r),o=generateAtkType(a,r),i=generateStat(a,r,"strength"),d=generateStat(a,r,"dexterity"),p=generateStat(a,r,"intelligence"),u=generateStat(a,r,"faith"),m=generateDmgType(a,r);s.appendChild(c),s.appendChild(l),s.appendChild(o),s.appendChild(i),s.appendChild(d),s.appendChild(p),s.appendChild(u),s.appendChild(m),t.appendChild(s)}function generateRow(e,n){var r=document.querySelector("#rowTemplate").cloneNode(!0);return r}function generateBlockBox(){var e=document.createElement("div");return e.classList="block-box",e}function generateName(e,n){var a=generateBlockBox(),r=document.createElement("span"),t=document.createElement("img");t.src="/weapons/"+e+".png",t.classList="guess-img",r.appendChild(t),r.classList="guess-span";var s=document.createElement("span");return s.classList="name-txt",s.textContent=n[e].name,r.appendChild(s),e==sessionStorage.getItem("weaponId")?r.classList.add("correct-span"):r.classList.add("incorrect-span"),a.appendChild(r),a}function generateWpnType(e,n){var a=generateBlockBox(),r=document.createElement("span");return r.classList="guess-span",r.textContent=capitalizeFirstLetter(n[e].weapon_type),n[e].weapon_type==n[sessionStorage.getItem("weaponId")].weapon_type?(r.classList.add("correct-span"),summWpnType.innerHTML="",summWpnType.appendChild(r.cloneNode(!0))):r.classList.add("incorrect-span"),a.appendChild(r),a}function generateAtkType(e,n){var a=generateBlockBox(),r=document.createElement("span");r.classList="guess-span",r.textContent=capitalizeFirstLetter(n[e].attack_type);var t=n[e].attack_type,s=n[sessionStorage.getItem("weaponId")].attack_type;return t==s?(r.classList.add("correct-span"),summAtkType.innerHTML="",summAtkType.appendChild(r.cloneNode(!0))):s.includes(t)||t.includes(s)?r.classList.add("partial-span"):r.classList.add("incorrect-span"),a.appendChild(r),a}function generateStat(weaponId,allWeapons,stat){var box=generateBlockBox(),span=document.createElement("span");span.classList="guess-span";var div=document.createElement("div"),thisReq=allWeapons[weaponId].requirements[stat],correctReq=allWeapons[sessionStorage.getItem("weaponId")].requirements[stat],thisScale=allWeapons[weaponId].bonus[stat],correctScale=allWeapons[sessionStorage.getItem("weaponId")].bonus[stat];if(thisReq==correctReq&&thisScale==correctScale)thisScale==null&&(thisScale="No"),span.textContent=thisReq+" / "+thisScale,span.classList.add("correct-span");else{if(thisReq!=correctReq&&thisScale!=correctScale?span.classList.add("incorrect-span"):span.classList.add("partial-span"),thisReq<correctReq){var arrow=createArrow("up");arrow.style.float="left",div.appendChild(arrow)}else if(thisReq>correctReq){var arrow=createArrow("down");arrow.style.float="left",div.appendChild(arrow)}var txt=document.createElement("span");if(thisScale==null&&(thisScale="No"),txt.textContent=thisReq+" / "+thisScale,div.appendChild(txt),thisScale<correctScale){var arrow=createArrow("up");arrow.style.float="right",div.lastChild.after(arrow)}else if(thisScale>correctScale||correctScale==null){var arrow=createArrow("down");arrow.style.float="right",div.lastChild.after(arrow)}}span.appendChild(div);var id="summ"+capitalizeFirstLetter(stat);return span.classList.contains("correct-span")&&(eval(id).innerHTML="",eval(id).appendChild(span.cloneNode(!0))),box.appendChild(span),box}function generateDmgType(e,n){var a=generateBlockBox(),r=document.createElement("span");r.classList="guess-span";var t=n[e].damage;t=Object.keys(t).map(o=>[o,t[o]]);var s=[];t.forEach(o=>{o[1]>0&&s.push(o[0])});var c=[],l=sessionStorage.getItem("weaponId");return t=n[l].damage,t=Object.keys(t).map(o=>[o,t[o]]),t.forEach(o=>{o[1]>0&&c.push(o[0])}),r.textContent=s.join(", "),arraysEqual(s,c)?(r.classList.add("correct-span"),summDmgType.innerHTML="",summDmgType.appendChild(r.cloneNode(!0))):s.filter(i=>c.includes(i)).length==0?r.classList.add("incorrect-span"):r.classList.add("partial-span"),a.appendChild(r),a}function populateDropdown(e){for(var n=0;n<e.length;n++){var a=document.createElement("span");a.id=n,a.classList="dropdown-row selection search-row";var r="/weapons/"+n+".png",t=document.createElement("img");t.src=r,t.id=n,t.classList="w-[48px] h-[48px]",t.title="&nbsp;"+e[n].name,a.appendChild(t);var s=document.createElement("span");s.title=e[n].name,s.id=n,s.textContent=e[n].name,s.classList.add("selection"),a.appendChild(s),document.querySelector("#myDropdown").appendChild(a)}}document.querySelector("#dropdownContainer").addEventListener("input",e=>{e.target.value!=""?document.querySelector("#myDropdown").classList.remove("hidden"):document.querySelector("#myDropdown").classList.add("hidden")});document.querySelector("#searchInput").addEventListener("input",searchFilter);document.addEventListener("click",e=>{e.target.closest("#searchInput")||document.querySelector("#myDropdown").classList.add("hidden")});document.querySelector("#searchInput").addEventListener("click",e=>{e.target.value!=""&&document.querySelector("#myDropdown").classList.remove("hidden")});function searchFilter(){for(var e=document.getElementById("searchInput"),n=e.value.toUpperCase(),a=document.querySelector("#myDropdown"),r=a.querySelectorAll(".search-row"),t=0;t<r.length;t++){var s=r[t].querySelector("span").textContent||r[t].querySelector("span").innerText;s.toUpperCase().indexOf(n)>-1?r[t].style.display="":r[t].style.display="none"}}function selectValue(e,n){return e.stopPropagation(),guessedWeapons.includes(e.target.title)?(document.querySelector("#repeatGuess").style.display="",!1):(document.querySelector("#repeatGuess").style.display="none",guessedWeapons.push(e.target.title),!0)}function attemptCounter(e){return attempts-=1,document.querySelector("#counter").innerHTML=attempts,(attempts==7||attempts==3)&&(document.querySelector("#btnClue").style.display=""),attempts==0&&!e&&(document.querySelector("#defeatScreen").checked=!0),attempts}function getClue(e){for(var n=document.querySelector("#summary"),a=n.children,r=[],t=1;t<7;t++)a[t].classList.contains("correct-span")||r.push(a[t]);var s=Math.floor(Math.random()*7+1),c=a[s],l;switch(s){case 1:l=generateWpnType(sessionStorage.weaponId,e);break;case 2:l=generateAtkType(sessionStorage.weaponId,e);break;case 3:l=generateStat(sessionStorage.weaponId,e,"strength");break;case 4:l=generateStat(sessionStorage.weaponId,e,"dexterity");break;case 5:l=generateStat(sessionStorage.weaponId,e,"intelligence");break;case 6:l=generateStat(sessionStorage.weaponId,e,"faith");break;case 7:l=generateDmgType(sessionStorage.weaponId,e);break}console.log(l),n.replaceChild(l,c)}function checkWeapon(e){return e==sessionStorage.weaponId?(console.log("victory"),document.querySelector("#victoryScreen").checked=!0,!0):!1}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function createArrow(e){var n=document.createElement("img");return n.src="/icons/arrow_"+e+".png",n.classList="arrow",n}function arraysEqual(e,n){if(e===n)return!0;if(e==null||n==null||e.length!==n.length)return!1;e.sort(),n.sort();for(var a=0;a<e.length;++a)if(e[a]!==n[a])return!1;return!0}
